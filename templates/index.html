{% extends "base.html" %}
{% block content %}
<h2>Schedule intelligence for Deans & Registrars ({{ active_term }})</h2>
<p class="lead">
  Clear, printable views for staffing decisions, conflict checks, and room load balance.
</p>

<p class="text-muted">
  Last generated: {{ last_generated or "Not generated yet" }} (server time)
</p>

<ol class="pl-3">
  <li>Upload the Excel schedule (add sheet name if not "GENERAL SCHEDULE").</li>
  <li>Click ‚ÄúRegenerate Visualizations‚Äù and wait for the spinner to finish.</li>
  <li>Open the Instructor or Room view links below for decision-ready charts.</li>
</ol>

<p class="mb-2">
  <strong>Outputs:</strong> Instructor view (by faculty), Room view (by space), and a clean Excel for audit trails.
</p>
<p class="mb-2">
  <strong>Built for quick decisions:</strong> Print-ready SVG charts and aligned time scales so everything lines up.
</p>

<p class="mb-2">
  <strong>Open visualizations:</strong>
  <a href="{{ url_for('view_instructor_chart') }}" class="link-primary">Instructor view</a>
  |
  <a href="{{ url_for('view_room_chart') }}" class="link-primary">Room view</a>
  |
  <a href="/download_processed" class="link-primary">Download processed schedule</a>
</p>

<p class="mb-4">
  <strong>Refresh anytime:</strong> Upload a new file to regenerate the charts‚Äîsmall smart steps to keep everyone aligned.
</p>

<form id="uploadForm" enctype="multipart/form-data">
  <div class="form-group">
    <label for="file">Upload your schedule file:</label>
    <input type="file" id="file" name="file" required />
  </div>

  <div class="form-group">
    <label for="sheet">Sheet Name:</label>
    <input
      type="text"
      id="sheet"
      name="sheet"
      value="GENERAL SCHEDULE"
      class="form-control"
      />
  </div>

  <button type="submit" class="btn btn-primary">Regenerate Visualizations</button>
</form>
<div id="spinner-container">
  <div class="spinner"></div>
  <p>Please wait while we process your file...</p>
</div>

<div id="message-area" class="mt-3"></div>
<div class="footer-message text-center mt-5">
  <hr />
  <p class="text-muted">
    This service is proudly offered by the <strong>Division of Research, Innovation, and Discovery</strong>. 
    Empowering education and advancing research one step at a time. üéâ
  </p>
</div>
{% endblock %}



{% block extrajs %}
<!-- Custom JS -->
<script
  src="{{ url_for('static', filename='js/index.js') }}"
  type="text/javascript"
  ></script>

{% endblock %}
